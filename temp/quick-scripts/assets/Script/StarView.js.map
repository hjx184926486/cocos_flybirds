{"version":3,"sources":["StarView.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../assets/Script","sourcesContent":["\nimport {MainScene} from \"./MainScene\";\nimport { GameManager } from \"./GameManager\";\nimport { HeroItem } from \"./HeroItem\";\nimport { SubDomController } from \"./SubDomController\";\nimport { User } from \"./User\"\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport  class StarView extends cc.Component {\n\n    @property( cc.Node)\n    private name_txt:cc.Node = null;\n\n    @property( cc.ScrollView )\n    private birdsScroll:cc.ScrollView = null;\n\n    @property( cc.Sprite )\n    private headPic:cc.Sprite = null;\n\n    @property( cc.Label )\n    private nick_name:cc.Label = null;\n\n    @property( cc.Label )\n    private coin_num:cc.Label = null;\n\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {}\n    private horScrollFlag:boolean = false; // 移动开动\n    private horScrollEaseFlag:boolean = false ;// 停止过后开关\n    private scrollItemWidth:number;\n    private scrollItemHeight:number;\n    private bigScrollItemWidth:number;\n    start () {\n        this.nameAnimate();\n        this.initScrollUi();\n        this.initScrollEvent();\n        this.setItemClick();\n        this.initTopUI();\n    }\n\n    // update (dt) {}\n    private nameAnimate(){\n        let action =  cc.sequence( \n            cc.moveTo(1.5,cc.p(0,370)),\n            cc.tintTo(1.5,255,255,255),\n            cc.callFunc(()=>{\n               \n            })\n         ) ;\n        action.easing(cc.easeBounceInOut());\n        this.name_txt.runAction( action )\n    }\n    \n    private initScrollEvent(){\n        this.birdsScroll.node.on('scrolling', this.horMove, this);\n        this.birdsScroll.node.on('scroll-ended', this.horMoveEnd, this);\n        \n    }\n    private initScrollUi(){\n        let scrollview:cc.Node = this.birdsScroll.node;\n        let content = this.birdsScroll.content;\n            cc.loader.loadRes(\"prefab/birdsItem\",cc.Prefab,(err, prefab)=>{\n                if (err != null) {\n                    console.log(err.message);\n                    return;\n                }\n                User.I.userData.skinData.forEach((val,idx) => {\n                    let item = cc.instantiate(prefab);\n                    item.getComponent(HeroItem).data = val;\n                    content.addChild( item );\n                    if( idx == 0 ){\n                        this.scrollItemWidth = item.width;\n                        this.scrollItemHeight = item.height;\n                        this.bigScrollItemWidth = item.width*1.5\n                        item.getComponent(HeroItem).changeSize(1.5);\n                    }\n                });\n            })\n    }\n    private horMove(){\n        let scrollview:cc.Node = this.birdsScroll.node;\n        let content = this.birdsScroll.content;\n        let items = content.children;\n        items.forEach((val,idx) => {\n            let x =  val.convertToWorldSpaceAR(cc.v2()).x-this.node.parent.x;\n            if( x > -this.bigScrollItemWidth && x < this.bigScrollItemWidth ){\n                let rate = 1.5 - Math.abs(x)/2/this.bigScrollItemWidth;\n                val.getComponent(HeroItem).changeSize(rate); \n            }else{\n                val.getComponent(HeroItem).changeSize(1);\n            }\n        });\n\n    }\n\n    private horMoveEnd(){\n        let scrollview:cc.Node = this.birdsScroll.node;\n        let content = scrollview.getChildByName(\"view\").getChildByName(\"content\")\n        let items = content.children;\n        let arr = [];\n        items.forEach((val,idx) => {\n            arr.push({val,idx});\n        });\n        arr.sort( (item1,item2)=>{\n            return item2.val.width - item1.val.width;\n        } )\n        let bigIdx = arr[0].idx;\n        items.forEach( (val,idx)=>{\n            let x  =  val.convertToWorldSpaceAR(cc.v2()).x-this.node.parent.x;\n            if( idx == bigIdx ){\n                let contentX = this.birdsScroll.getContentPosition()[\"x\"];\n                contentX = contentX-x;\n                this.birdsScroll.setContentPosition( cc.p(contentX,0)  )\n                val.getComponent(HeroItem).changeSize(1.5);\n            }\n            if( x > -this.bigScrollItemWidth && x < this.bigScrollItemWidth ){\n                let rate = 1.5 - Math.abs(x)/2/this.bigScrollItemWidth;\n                val.getComponent(HeroItem).changeSize(rate); \n            }else{\n                val.getComponent(HeroItem).changeSize(1);\n            }\n        })\n    }\n\n    private setItemClick(){\n        let scrollview:cc.Node = this.birdsScroll.node;\n        let content = scrollview.getChildByName(\"view\").getChildByName(\"content\")\n        let items = content.children;\n        items.forEach( (val,idx)=>{\n            val.getComponent(HeroItem).setClick( ()=>{\n\n            },this );\n        } )\n    }\n\n    private initTopUI(){\n        SubDomController.getUserInfo( (res)=>{\n            cc.loader.load(`${res.avatarUrl}?aa=aa.jpg` ,(err, texture)=> {\n                var frame = new cc.SpriteFrame(texture);\n                this.headPic.spriteFrame = frame;\n            });\n            this.nick_name.string = res.nickname\n        })\n        this.coin_num.string = \"\"+2000;\n    }\n}\n"]}